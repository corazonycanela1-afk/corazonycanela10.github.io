<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carrito</title>

<style>
body{
margin:0;
font-family:Arial, Helvetica, sans-serif;
background:#f5f5f5;
}

/* NAV */
.nav{
background:#f4b9b9;
padding:15px;
display:flex;
align-items:center;
justify-content:center;
position:relative;
font-size:22px;
font-weight:bold;
}

.menu-icon{
position:absolute;
left:20px;
font-size:28px;
cursor:pointer;
}

.menu-desplegable{
display:none;
position:absolute;
top:60px;
left:20px;
background:white;
border-radius:10px;
box-shadow:0 5px 15px rgba(0,0,0,0.2);
padding:10px;
z-index:1000;
}

.menu-desplegable a{
display:block;
padding:10px;
text-decoration:none;
color:#8b4513;
font-weight:bold;
}

.menu-desplegable a:hover{
background:#f8c8dc;
border-radius:8px;
}

/* CONTENEDOR */
.contenedor{
padding:20px;
max-width:800px;
margin:auto;
}

/* PRODUCTO */
.producto-carrito{
background:white;
padding:15px;
margin-bottom:15px;
display:flex;
align-items:center;
gap:15px;
border-radius:10px;
}

.producto-carrito img{
width:80px;
height:80px;
object-fit:cover;
border-radius:8px;
}

.total{
font-size:20px;
font-weight:bold;
margin-top:20px;
text-align:right;
}

/* BOTÓN PAGAR */
.boton-pagar{
background:#e96a9c;
color:white;
padding:12px 30px;
border:none;
border-radius:25px;
font-size:16px;
cursor:pointer;
display:block;
margin:30px auto;
transition:0.3s;
}

.boton-pagar:hover{
background:#d94b83;
}

/* MODAL */
.modal{
display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.6);
justify-content:center;
align-items:center;
}

.modal-contenido{
background:white;
padding:25px;
width:350px;
border-radius:15px;
text-align:center;
max-height:90%;
overflow:auto;
}

.modal input, .modal select{
width:90%;
padding:8px;
margin:8px 0;
border-radius:8px;
border:1px solid #ccc;
}

.boton-confirmar{
background:#e96a9c;
color:white;
padding:10px;
border:none;
border-radius:20px;
width:90%;
cursor:pointer;
margin-top:10px;
}

.boton-cancelar{
background:#ccc;
padding:8px;
border:none;
border-radius:20px;
width:90%;
cursor:pointer;
margin-top:5px;
}
</style>
</head>

<body>

<!-- NAV CON 3 RAYITAS -->
<div class="nav">
<div class="menu-icon" onclick="toggleMenu()">☰</div>
Tu Carrito
</div>

<div class="menu-desplegable" id="menu">
<a href="index.html">Inicio</a>
<a href="Productos.html">Productos</a>
</div>

<div class="contenedor">
<div id="lista-carrito"></div>
<div class="total" id="total"></div>

<button class="boton-pagar" onclick="abrirCheckout()">Pagar</button>
</div>

<!-- MODAL CHECKOUT -->
<div class="modal" id="checkout">
<div class="modal-contenido">

<h2>Finalizar compra</h2>

<input type="text" id="nombre" placeholder="Nombre completo">
<input type="text" id="direccion" placeholder="Dirección">
<input type="text" id="ciudad" placeholder="Ciudad">
<input type="text" id="estado" placeholder="Estado">
<input type="text" id="telefono" placeholder="Teléfono">

<h3>Fecha de entrega</h3>
<input type="date" id="fecha">

<h3>Hora de entrega</h3>
<input type="time" id="hora">

<h3>Método de pago</h3>
<select id="metodo" onchange="mostrarCamposPago()">
<option value="">Selecciona método</option>
<option value="tarjeta">Tarjeta</option>
<option value="transferencia">Transferencia</option>
<option value="efectivo">Efectivo contra entrega</option>
</select>

<div id="campos-pago"></div>
<h3 id="total-checkout"></h3>

<button class="boton-confirmar" onclick="confirmarPago()">Confirmar pago</button>
<button class="boton-cancelar" onclick="cerrarCheckout()">Cancelar</button>

</div>
</div>

<script>

/* MENU */
function toggleMenu(){
let menu = document.getElementById("menu");
menu.style.display = menu.style.display === "block" ? "none" : "block";
}

/* CAMPOS DE PAGO */
function mostrarCamposPago(){
let metodo = document.getElementById("metodo").value;
let contenedor = document.getElementById("campos-pago");

if(metodo === "tarjeta"){
contenedor.innerHTML = `
<input type="text" id="numTarjeta" placeholder="Número de tarjeta (16 dígitos)" maxlength="16">
<input type="text" id="fechaTarjeta" placeholder="MM/AA">
<input type="text" id="cvv" placeholder="CVV" maxlength="3">
`;
}
else if(metodo === "transferencia"){
contenedor.innerHTML = `
<input type="text" id="referencia" placeholder="Número de referencia">
`;
}
else{
contenedor.innerHTML = "";
}
}

/* CARRITO */
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
let contenedor = document.getElementById("lista-carrito");
let total = 0;

if(carrito.length === 0){
contenedor.innerHTML = "<p>No hay productos en el carrito.</p>";
}

carrito.forEach((producto, index) => {
let subtotal = producto.precio * producto.cantidad;
total += subtotal;

contenedor.innerHTML += `
<div class="producto-carrito">
<img src="${producto.img}">
<div>
<b>${producto.nombre}</b><br>
Precio: $${producto.precio}<br>
Cantidad: ${producto.cantidad}<br>
Subtotal: $${subtotal}
</div>
<button onclick="eliminar(${index})">❌</button>
</div>
`;
});

document.getElementById("total").innerText = "Total: $" + total;

function eliminar(index){
carrito.splice(index,1);
localStorage.setItem("carrito", JSON.stringify(carrito));
location.reload();
}

function abrirCheckout(){
if(carrito.length === 0){
alert("Tu carrito está vacío");
return;
}
document.getElementById("checkout").style.display="flex";
document.getElementById("total-checkout").innerText =
"Total a pagar: $" + total;
}

function cerrarCheckout(){
document.getElementById("checkout").style.display="none";
}

function confirmarPago(){
let nombre = document.getElementById("nombre").value;
let direccion = document.getElementById("direccion").value;
let telefono = document.getElementById("telefono").value;
let metodo = document.getElementById("metodo").value;
let fecha = document.getElementById("fecha").value;
let hora = document.getElementById("hora").value;

if(nombre === "" || direccion === "" || telefono === "" || metodo === "" || fecha === "" || hora === ""){
alert("Por favor llena todos los campos");
return;
}

if(metodo === "tarjeta"){
let tarjeta = document.getElementById("numTarjeta").value;
let cvv = document.getElementById("cvv").value;

if(tarjeta.length !== 16 || cvv.length !== 3){
alert("Revisa los datos de la tarjeta");
return;
}
}

alert("Gracias por tu compra ❤️\nEntrega el " + fecha + " a las " + hora);

localStorage.removeItem("carrito");
location.reload();
}
</script>

</body>
</html>